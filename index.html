<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Coco Banana ¬∑ Premium Nightclub Experience</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- PWA manifest (optional, safe to keep even without SW) -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#000000">
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script>

  <style>
    :root {
      --bg: #000000;
      --bg-alt: #0a0015;
      --bg-soft: #1a0025;
      --neon-pink: #ff2d95;
      --neon-blue: #00f0ff;
      --neon-purple: #b967ff;
      --lux-gold: #ffd700;
      --lux-gold-glow: #ffed4e;
      --text-main: #ffffff;
      --text-muted: #b0b0b0;
      --danger: #ff3860;
      --success: #00d4aa;
      --border-soft: rgba(255,255,255,0.15);
      --glass-bg: rgba(0, 0, 0, 0.7);
      --glass-border: rgba(255,255,255,0.2);
      --premium-glow: 0 0 30px rgba(255, 215, 0, 0.6);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: 
        radial-gradient(ellipse at 20% 20%, rgba(255, 45, 149, 0.25) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(0, 240, 255, 0.2) 0%, transparent 50%),
        radial-gradient(ellipse at 40% 60%, rgba(185, 103, 255, 0.15) 0%, transparent 50%),
        linear-gradient(135deg, #000000 0%, #0a0015 30%, #1a0025 70%, #000000 100%);
      background-attachment: fixed;
      color: var(--text-main);
      min-height: 100vh;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 30%, rgba(255, 45, 149, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(0, 240, 255, 0.08) 0%, transparent 50%);
      pointer-events: none;
      z-index: -1;
    }

    .app {
      max-width: 520px;
      margin: 0 auto;
      padding: 20px 16px 30px;
      position: relative;
    }

    /* Premium Logo with Animation */
    .logo-wrap { 
      text-align: center; 
      margin-bottom: 20px;
      position: relative;
      cursor: pointer;
    }

    .logo-text-main {
      font-size: 52px;
      font-weight: 900;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: transparent;
      background: linear-gradient(45deg, var(--neon-pink), var(--neon-blue), var(--lux-gold));
      background-clip: text;
      -webkit-background-clip: text;
      text-shadow: 0 0 30px rgba(255, 45, 149, 0.5);
      margin-bottom: -8px;
      position: relative;
      animation: logoGlow 3s ease-in-out infinite alternate;
    }

    .logo-text-sub {
      font-family: "Playfair Display", serif;
      font-size: 28px;
      font-weight: 700;
      color: var(--lux-gold);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      text-shadow: 
        0 0 20px var(--lux-gold-glow),
        0 0 40px rgba(255, 215, 0, 0.4);
      position: relative;
    }

    .logo-text-sub::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--lux-gold), transparent);
    }

    @keyframes logoGlow {
      0% { text-shadow: 0 0 20px rgba(255, 45, 149, 0.5), 0 0 40px rgba(0, 240, 255, 0.3); }
      100% { text-shadow: 0 0 30px rgba(255, 45, 149, 0.8), 0 0 60px rgba(0, 240, 255, 0.5); }
    }

    .tagline { 
      text-align: center; 
      font-size: 13px; 
      color: var(--text-muted); 
      margin-bottom: 20px; 
      line-height: 1.5;
      letter-spacing: 0.05em;
    }

    /* Premium Flash Deal - Nightclub Style */
    .flash-bar {
      border-radius: 20px;
      padding: 18px 20px;
      margin-bottom: 24px;
      background: linear-gradient(135deg, rgba(255, 45, 149, 0.15), rgba(0, 0, 0, 0.9));
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 45, 149, 0.3);
      position: relative;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      cursor: pointer;
      box-shadow: 0 8px 32px rgba(255, 45, 149, 0.2);
    }

    .flash-bar::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.6s ease;
    }

    .flash-bar:hover::before {
      left: 100%;
    }

    .flash-bar:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 40px rgba(255, 45, 149, 0.4);
      border-color: rgba(255, 45, 149, 0.6);
    }

    .flash-bar.inactive { 
      opacity: 0.8;
      background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(0, 0, 0, 0.9));
      border-color: rgba(255,255,255,0.1);
    }

    .flash-bar.active { 
      animation: premiumPulse 2s ease-in-out infinite;
      border-color: rgba(255, 45, 149, 0.8);
      box-shadow: 0 0 30px rgba(255, 45, 149, 0.4), 0 8px 32px rgba(255, 45, 149, 0.3);
    }

    .flash-bar.ending-soon {
      animation: urgentPulse 1s ease-in-out infinite;
      border-color: rgba(255, 56, 96, 0.8);
      box-shadow: 0 0 40px rgba(255, 56, 96, 0.6), 0 8px 32px rgba(255, 56, 96, 0.4);
    }

    @keyframes premiumPulse {
      0%, 100% { 
        box-shadow: 0 0 20px rgba(255, 45, 149, 0.4), 0 8px 32px rgba(255, 45, 149, 0.3);
      }
      50% { 
        box-shadow: 0 0 40px rgba(255, 45, 149, 0.8), 0 12px 48px rgba(255, 45, 149, 0.6);
      }
    }

    @keyframes urgentPulse {
      0%, 100% { 
        box-shadow: 0 0 25px rgba(255, 56, 96, 0.6), 0 8px 32px rgba(255, 56, 96, 0.4);
      }
      50% { 
        box-shadow: 0 0 50px rgba(255, 56, 96, 1), 0 12px 48px rgba(255, 56, 96, 0.8);
      }
    }

    .flash-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
      gap: 10px;
    }

    .flash-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--neon-pink);
    }

    .flash-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--neon-pink);
      box-shadow: 0 0 20px var(--neon-pink);
      animation: dotPulse 1.5s ease-in-out infinite;
    }

    @keyframes dotPulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.3); opacity: 0.7; }
    }

    .flash-pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      background: linear-gradient(135deg, rgba(255, 45, 149, 0.2), rgba(0, 240, 255, 0.2));
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: var(--neon-blue);
      backdrop-filter: blur(10px);
    }

    .flash-body {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      gap: 15px;
      font-size: 14px;
    }

    .flash-item-name { 
      font-weight: 700;
      font-size: 18px;
      color: var(--text-main);
    }

    .flash-item-meta { 
      font-size: 13px; 
      color: var(--neon-blue);
      margin-top: 4px;
    }

    .flash-timer { 
      text-align: right;
      min-width: 80px;
    }

    .flash-timer-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .flash-timer-value {
      font-size: 20px;
      font-weight: 800;
      color: var(--lux-gold);
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
      font-feature-settings: "tnum";
    }

    .flash-meter {
      margin-top: 15px;
      width: 100%;
      height: 4px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.1);
      overflow: hidden;
      position: relative;
    }

    .flash-meter-fill {
      width: 100%;
      height: 100%;
      border-radius: 10px;
      background: linear-gradient(90deg, var(--neon-pink), var(--lux-gold));
      transform-origin: left center;
      transform: scaleX(1);
      transition: transform 0.5s linear;
      position: relative;
    }

    .flash-meter-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    /* Premium Tabs */
    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
      justify-content: center;
    }

    .tab-btn {
      border-radius: 25px;
      padding: 12px 20px;
      font-size: 14px;
      font-weight: 600;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(0, 0, 0, 0.6);
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }

    .tab-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.5s;
    }

    .tab-btn:hover::before {
      left: 100%;
    }

    .tab-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-main);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .tab-btn.active {
      background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
      color: #000;
      border-color: transparent;
      box-shadow: 0 5px 20px rgba(255, 45, 149, 0.4);
      font-weight: 700;
    }

    /* Premium Cards */
    .section { 
      margin-bottom: 25px;
      animation: fadeInUp 0.6s ease-out;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .section-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding: 0 5px;
    }

    .section-title {
      font-size: 20px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: var(--text-main);
      position: relative;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 40px;
      height: 2px;
      background: linear-gradient(90deg, var(--neon-pink), transparent);
    }

    .section-tag { 
      font-size: 12px; 
      color: var(--neon-blue);
      letter-spacing: 0.1em;
    }

    .card-list { 
      display: flex; 
      flex-direction: column; 
      gap: 15px;
    }

    .card {
      padding: 20px;
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(0, 0, 0, 0.8));
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
      transition: left 0.6s ease;
    }

    .card:hover::before {
      left: 100%;
    }

    .card:hover {
      transform: translateY(-5px);
      border-color: rgba(255, 255, 255, 0.3);
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.5),
        0 0 0 1px rgba(255, 255, 255, 0.1);
    }

    .card-main {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 15px;
    }

    .card-name { 
      font-size: 17px; 
      font-weight: 600;
      color: var(--text-main);
    }

    .card-price {
      font-size: 18px;
      font-weight: 700;
      color: var(--lux-gold);
      white-space: nowrap;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    }

    .card-price .strike { 
      text-decoration: line-through; 
      opacity: 0.5; 
      margin-right: 8px;
      color: var(--text-muted);
    }

    .card-price .discount { 
      color: var(--neon-pink); 
      font-weight: 800;
      text-shadow: 0 0 10px rgba(255, 45, 149, 0.5);
    }

    .popular-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
      color: #000;
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: 900;
      transform: rotate(5deg);
      box-shadow: 0 4px 15px rgba(255, 45, 149, 0.4);
      letter-spacing: 0.1em;
      z-index: 2;
    }

    /* Premium Spin Sections */
    .spin-wrap { 
      margin-top: 10px;
      animation: fadeInUp 0.8s ease-out;
    }

    .spin-panel {
      padding: 25px;
      border-radius: 20px;
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(255, 45, 149, 0.1));
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.15);
      position: relative;
      overflow: hidden;
      margin-bottom: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    }

    .spin-panel::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--neon-pink), var(--neon-blue), transparent);
    }

    .gold-spin-panel {
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(255, 215, 0, 0.15));
      border: 1px solid rgba(255, 215, 0, 0.4);
      box-shadow: 0 10px 40px rgba(255, 215, 0, 0.2);
    }

    .gold-spin-panel::before {
      background: linear-gradient(90deg, transparent, var(--lux-gold), var(--neon-pink), transparent);
    }

    .spin-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 20px;
      gap: 15px;
    }

    .spin-title {
      font-size: 22px;
      font-weight: 800;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      background: linear-gradient(135deg, var(--neon-blue), var(--neon-pink));
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      text-shadow: 0 0 20px rgba(0, 240, 255, 0.3);
    }

    .spin-title.gold {
      background: linear-gradient(135deg, var(--lux-gold), #ff6b00);
      background-clip: text;
      -webkit-background-clip: text;
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
    }

    .spin-sub {
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 8px;
      line-height: 1.5;
      max-width: 300px;
    }

    .wheel-container {
      position: relative;
      width: 220px;
      height: 220px;
      margin: 20px auto;
    }

    .spin-wheel, .golden-wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      position: relative;
      overflow: hidden;
      transition: transform 4s cubic-bezier(0.2, 0.8, 0.3, 1);
      box-shadow: 
        0 0 0 4px rgba(255, 255, 255, 0.1),
        0 0 30px rgba(0, 0, 0, 0.8);
    }

    .spin-wheel {
      background: conic-gradient(
        from 0deg,
        var(--neon-pink) 0deg 60deg,
        var(--neon-blue) 60deg 120deg,
        var(--neon-purple) 120deg 180deg,
        var(--lux-gold) 180deg 240deg,
        var(--success) 240deg 300deg,
        var(--danger) 300deg 360deg
      );
    }

    .golden-wheel {
      background: conic-gradient(
        from 0deg,
        #ffd700 0deg 40deg,
        #ff6b00 40deg 80deg,
        #ff4444 80deg 120deg,
        #ffd700 120deg 160deg,
        #ff6b00 160deg 200deg,
        #ff4444 200deg 240deg,
        #ffd700 240deg 280deg,
        #ff6b00 280deg 320deg,
        #ff4444 320deg 360deg
      );
    }

    .wheel-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 50px;
      height: 50px;
      background: rgba(0, 0, 0, 0.9);
      border-radius: 50%;
      border: 3px solid rgba(255, 255, 255, 0.8);
      z-index: 10;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
    }

    .wheel-pointer {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-top: 35px solid var(--neon-pink);
      z-index: 20;
      filter: drop-shadow(0 0 10px rgba(255, 45, 149, 0.8));
    }

    .gold-spin-panel .wheel-pointer {
      border-top-color: var(--lux-gold);
      filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
    }

    .spin-wheel.spinning, .golden-wheel.spinning {
      animation: premiumSpin 4s cubic-bezier(0.2, 0.8, 0.3, 1);
    }

    @keyframes premiumSpin {
      0% { 
        transform: rotate(0deg);
        filter: hue-rotate(0deg);
      }
      100% { 
        transform: rotate(1440deg);
        filter: hue-rotate(360deg);
      }
    }

    .spin-btn {
      margin-top: 20px;
      width: 100%;
      padding: 18px 24px;
      border-radius: 50px;
      border: none;
      cursor: pointer;
      font-size: 18px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
      color: #000;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.3);
      box-shadow: 
        0 5px 20px rgba(255, 45, 149, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.1);
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      position: relative;
      overflow: hidden;
    }

    .spin-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .spin-btn:hover::before {
      left: 100%;
    }

    .spin-btn:hover {
      transform: translateY(-3px);
      box-shadow: 
        0 8px 30px rgba(255, 45, 149, 0.6),
        0 0 0 1px rgba(255, 255, 255, 0.2);
    }

    .spin-btn.gold {
      background: linear-gradient(135deg, var(--lux-gold), #ff6b00);
      box-shadow: 
        0 5px 20px rgba(255, 215, 0, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.1);
    }

    .spin-btn.gold:hover {
      box-shadow: 
        0 8px 30px rgba(255, 215, 0, 0.6),
        0 0 0 1px rgba(255, 255, 255, 0.2);
    }

    .spin-btn:active {
      transform: translateY(-1px);
    }

    .spin-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .spin-btn.spinning {
      animation: btnPulse 0.8s ease-in-out infinite;
    }

    @keyframes btnPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    .spin-result {
      margin-top: 20px;
      min-height: 50px;
      font-size: 16px;
      text-align: center;
      padding: 15px;
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
    }

    .spin-result-main {
      font-weight: 700;
      font-size: 18px;
      display: block;
      margin-bottom: 5px;
    }

    .spin-result-main.big {
      font-size: 24px;
      color: var(--lux-gold);
      text-shadow: 
        0 0 20px var(--lux-gold-glow),
        0 0 40px rgba(255, 215, 0, 0.5);
      animation: resultGlow 2s ease-in-out infinite;
    }

    @keyframes resultGlow {
      0%, 100% { text-shadow: 0 0 20px var(--lux-gold-glow), 0 0 40px rgba(255, 215, 0, 0.5); }
      50% { text-shadow: 0 0 30px var(--lux-gold-glow), 0 0 60px rgba(255, 215, 0, 0.8); }
    }

    .spin-result-main.mid { 
      color: var(--neon-blue);
      text-shadow: 0 0 10px rgba(0, 240, 255, 0.5);
    }

    .spin-result-main.low { 
      color: var(--text-muted);
    }

    .spin-result-note {
      font-size: 13px;
      color: var(--text-muted);
      line-height: 1.4;
    }

    /* Prize Grids */
    .silver-prizes, .gold-prizes-title {
      margin-top: 25px;
    }

    .silver-prizes-title, .gold-prizes-title {
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      margin-bottom: 15px;
      color: var(--neon-blue);
      text-align: center;
      font-weight: 700;
    }

    .gold-prizes-title {
      color: var(--lux-gold);
    }

    .silver-prizes-grid, .premium-prizes-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .prize-item {
      padding: 16px 20px;
      border-radius: 14px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      position: relative;
      backdrop-filter: blur(10px);
    }

    .prize-item:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateX(5px);
    }

    .prize-item.big-prize {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(255, 45, 149, 0.1));
      border: 2px solid rgba(255, 215, 0, 0.6);
      box-shadow: 
        0 5px 20px rgba(255, 215, 0, 0.3),
        inset 0 0 20px rgba(255, 215, 0, 0.1);
      animation: luxuryPulse 3s ease-in-out infinite;
    }

    .prize-item.big-prize::before {
      content: '‚ú®';
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 18px;
      animation: sparkle 2s ease-in-out infinite;
    }

    @keyframes sparkle {
      0%, 100% { opacity: 1; transform: translateY(-50%) scale(1); }
      50% { opacity: 0.7; transform: translateY(-50%) scale(1.1); }
    }

    .prize-text {
      font-weight: 700;
      margin-left: 35px;
      font-size: 14px;
    }

    .prize-item.big-prize .prize-text {
      color: var(--lux-gold);
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }

    .prize-value {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 4px;
      margin-left: 35px;
    }

    .prize-item.big-prize .prize-value {
      color: #ffa500;
      font-weight: 600;
    }

    @keyframes luxuryPulse {
      0%, 100% { 
        box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3), inset 0 0 20px rgba(255, 215, 0, 0.1);
        transform: scale(1);
      }
      50% { 
        box-shadow: 0 8px 30px rgba(255, 215, 0, 0.6), inset 0 0 30px rgba(255, 215, 0, 0.2);
        transform: scale(1.02);
      }
    }

    /* Spin Code Input */
    .spin-code-panel {
      margin-top: 20px;
      padding: 20px;
      border-radius: 16px;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(15px);
      border: 1px dashed rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .spin-code-input {
      display: flex;
      gap: 12px;
      margin-top: 15px;
      justify-content: center;
      align-items: center;
    }

    .spin-code-input input {
      width: 100px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(0, 0, 0, 0.8);
      color: var(--text-main);
      font-size: 18px;
      text-align: center;
      letter-spacing: 4px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .spin-code-input input:focus {
      outline: none;
      border-color: var(--neon-blue);
      box-shadow: 0 0 20px rgba(0, 240, 255, 0.3);
    }

    .spin-code-btn {
      padding: 12px 24px;
      border-radius: 12px;
      border: none;
      background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
      color: #000;
      cursor: pointer;
      font-size: 14px;
      font-weight: 700;
      transition: all 0.3s ease;
      letter-spacing: 0.1em;
    }

    .spin-code-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 240, 255, 0.4);
    }

    .spin-code-msg {
      margin-top: 12px;
      font-size: 13px;
      color: var(--text-muted);
      min-height: 20px;
    }

    .spin-code-error {
      color: var(--danger) !important;
      text-shadow: 0 0 10px rgba(255, 56, 96, 0.3);
    }

    .spin-code-success {
      color: var(--success) !important;
      text-shadow: 0 0 10px rgba(0, 212, 170, 0.3);
    }

    .loading-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid transparent;
      border-top: 3px solid var(--neon-blue);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Hidden Admin System */
    .admin-bar {
      margin-top: 15px;
      text-align: center;
      font-size: 11px;
      color: rgba(255, 255, 255, 0.3);
      letter-spacing: 0.1em;
    }

    .admin-panel {
      margin-top: 15px;
      padding: 20px;
      border-radius: 16px;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 13px;
      display: none;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.7);
    }

    .admin-panel > div:first-child {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 10px;
      color: var(--neon-blue);
      text-align: center;
    }

    .admin-badge {
      font-size: 12px;
      color: var(--success);
      margin-top: 5px;
      text-align: center;
      font-weight: 600;
    }

    .admin-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .admin-row:last-child {
      border-bottom: none;
    }

    .switch {
      position: relative;
      width: 50px;
      height: 26px;
      border-radius: 25px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      cursor: pointer;
      flex-shrink: 0;
      transition: all 0.3s ease;
    }

    .switch:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .switch-knob {
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--text-main);
      transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }

    .switch.on {
      background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
      border-color: transparent;
    }

    .switch.on .switch-knob {
      transform: translateX(24px);
      background: #000;
    }

    .admin-input, .admin-select {
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(0, 0, 0, 0.6);
      color: var(--text-main);
      font-size: 13px;
      min-width: 80px;
    }

    .admin-select {
      min-width: 160px;
    }

    .admin-login {
      margin-top: 15px;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .admin-login input {
      flex: 1;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(0, 0, 0, 0.6);
      color: var(--text-main);
      font-size: 14px;
      text-align: center;
      letter-spacing: 2px;
    }

    .admin-login button {
      padding: 10px 20px;
      border-radius: 8px;
      border: none;
      background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
      color: #000;
      cursor: pointer;
      font-size: 13px;
      font-weight: 700;
      transition: all 0.3s ease;
    }

    .admin-login button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 240, 255, 0.4);
    }

    #adminFlashSummary {
      margin-top: 15px;
      font-size: 12px;
      color: var(--text-muted);
      text-align: center;
      padding: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
    }

    .preset-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .preset-btn {
      padding: 8px 16px;
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-muted);
      cursor: pointer;
      font-size: 11px;
      font-weight: 600;
      transition: all 0.3s ease;
      letter-spacing: 0.1em;
      text-transform: uppercase;
    }

    .preset-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-main);
      transform: translateY(-2px);
    }

    .preset-btn.weekday:hover { border-color: var(--neon-blue); }
    .preset-btn.weekend:hover { border-color: var(--neon-pink); }
    .preset-btn.party:hover { border-color: var(--lux-gold); }

    .footer {
      margin-top: 50px;
      font-size: 11px;
      text-align: center;
      color: var(--text-muted);
      line-height: 1.6;
      letter-spacing: 0.05em;
      padding: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Quick Navigation */
    .quick-nav {
      position: fixed;
      bottom: 25px;
      right: 25px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 1000;
    }

    .quick-nav button {
      width: 55px;
      height: 55px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
      border: none;
      color: #000;
      font-size: 22px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      box-shadow: 0 5px 20px rgba(255, 45, 149, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .quick-nav button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .quick-nav button:hover::before {
      left: 100%;
    }

    .quick-nav button:hover {
      transform: scale(1.15) translateY(-3px);
      box-shadow: 0 8px 30px rgba(255, 45, 149, 0.6);
    }

    .quick-nav button:nth-child(2) {
      background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
      box-shadow: 0 5px 20px rgba(0, 240, 255, 0.4);
    }

    .quick-nav button:nth-child(3) {
      background: linear-gradient(135deg, var(--lux-gold), #ff6b00);
      box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
    }

    .quick-nav button:nth-child(4) {
      background: linear-gradient(135deg, var(--success), var(--neon-blue));
      box-shadow: 0 5px 20px rgba(0, 212, 170, 0.4);
    }

    #scrollTopBtn {
      background: linear-gradient(135deg, #666, #999) !important;
      box-shadow: 0 5px 20px rgba(255, 255, 255, 0.2) !important;
      display: none;
    }

    /* Skeleton Loading */
    #loadingSkeleton { display: none; margin-bottom: 20px; }
    .skeleton-card {
      height: 70px;
      border-radius: 16px;
      background: linear-gradient(90deg, rgba(255,255,255,0.05), rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      background-size: 200% 100%;
      animation: shimmer 1.5s ease-in-out infinite;
      margin-bottom: 12px;
      border: 1px solid rgba(255,255,255,0.05);
      backdrop-filter: blur(10px);
    }

    /* Responsive Design */
    @media (max-width: 480px) {
      .app { padding: 15px 12px 25px; }
      .logo-text-main { font-size: 42px; letter-spacing: 0.25em; }
      .logo-text-sub { font-size: 24px; }
      .flash-bar { padding: 15px; }
      .wheel-container { width: 200px; height: 200px; }
      .quick-nav { bottom: 15px; right: 15px; }
      .quick-nav button { width: 50px; height: 50px; font-size: 20px; }
      .tabs { gap: 8px; }
      .tab-btn { padding: 10px 16px; font-size: 13px; }
      .spin-panel { padding: 20px; }
    }

    @media (max-width: 380px) {
      .logo-text-main { font-size: 36px; }
      .logo-text-sub { font-size: 20px; }
      .flash-body { flex-direction: column; align-items: flex-start; gap: 10px; }
      .flash-timer { text-align: left; }
    }

    /* Accessibility */
    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; }
    }

    /* High contrast mode */
    @media (prefers-contrast: high) {
      :root {
        --text-main: #ffffff;
        --text-muted: #cccccc;
        --border-soft: rgba(255,255,255,0.8);
      }
      .card { border: 2px solid var(--border-soft); }
      .spin-btn { border: 2px solid white; }
    }
  </style>
</head>
<body>
<div class="app">
  <!-- Premium Logo (hidden admin trigger via tapping/holding) -->
  <div class="logo-wrap">
    <div class="logo-text-main">COCO</div>
    <div class="logo-text-sub">BANANA</div>
  </div>
  
  <div class="tagline">
    Premium Nightclub Experience ¬∑ Ulaanbaatar ¬∑ 21+ ¬∑ Order & payment through our staff
  </div>

  <!-- Skeleton Loading -->
  <div id="loadingSkeleton">
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
  </div>

  <!-- Premium Flash Deal -->
  <div id="flashBar" class="flash-bar inactive">
    <div class="flash-header">
      <div class="flash-title">
        <div class="flash-dot"></div>
        <span>EXCLUSIVE DEAL</span>
      </div>
      <div class="flash-pill">Limited Time</div>
    </div>
    <div class="flash-body">
      <div>
        <div id="flashItemName" class="flash-item-name">No active deals</div>
        <div id="flashItemMeta" class="flash-item-meta">Check back for exclusive offers</div>
      </div>
      <div class="flash-timer">
        <div class="flash-timer-label">TIME LEFT</div>
        <div id="flashTimerValue" class="flash-timer-value">--:--</div>
      </div>
    </div>
    <div class="flash-meter">
      <div id="flashMeterFill" class="flash-meter-fill"></div>
    </div>
  </div>

  <!-- Premium Tabs -->
  <div class="tabs" id="tabs">
    <button class="tab-btn active" data-tab="all">ALL</button>
    <button class="tab-btn" data-tab="cocktails">COCKTAILS</button>
    <button class="tab-btn" data-tab="beer">BEER</button>
    <button class="tab-btn" data-tab="whiskey">WHISKEY</button>
    <button class="tab-btn" data-tab="vodka">VODKA</button>
    <button class="tab-btn" data-tab="gin">GIN</button>
    <button class="tab-btn" data-tab="tequila">TEQUILA</button>
    <button class="tab-btn" data-tab="cognac">COGNAC</button>
    <button class="tab-btn" data-tab="wine">WINE</button>
    <button class="tab-btn" data-tab="liquor">LIQUEUR</button>
    <button class="tab-btn" data-tab="sets">SETS</button>
    <button class="tab-btn" data-tab="snacks">SNACKS</button>
    <button class="tab-btn" data-tab="softdrinks">MIXERS</button>
  </div>

  <!-- Menu Container -->
  <div id="menuContainer"></div>

  <!-- SILVER SPIN -->
  <div class="spin-wrap" id="silverSpinSection">
    <div class="spin-panel">
      <div class="spin-header">
        <div>
          <div class="spin-title">SILVER SPIN</div>
          <div class="spin-sub">Premium prizes ¬∑ Staff activation required after payment ¬∑ One spin per activation</div>
        </div>
        <div class="flash-pill">Staff Code</div>
      </div>

      <div class="wheel-container">
        <div id="spinWheel" class="spin-wheel"></div>
        <div class="wheel-center"></div>
        <div class="wheel-pointer"></div>
      </div>

      <div class="spin-code-panel" id="spinCodePanel">
        <div style="font-size: 14px; color: var(--neon-blue); font-weight: 600;">STAFF ACTIVATION REQUIRED</div>
        <div class="spin-code-input">
          <input type="password" id="spinCodeInput" maxlength="6" placeholder="000000" />
          <button class="spin-code-btn" id="spinCodeBtn">ACTIVATE</button>
        </div>
        <div class="spin-code-msg" id="spinCodeMsg">Payment required before spin activation</div>
      </div>

      <button class="spin-btn" id="spinButton" disabled>ENTER CODE TO SPIN</button>
      
      <div class="spin-result" id="spinResult">
        <span class="spin-result-main">Payment required for Silver Spin</span><br/>
        <span class="spin-result-note">Contact staff to activate your spin after payment</span>
      </div>

      <div class="silver-prizes" id="silverPrizes">
        <div class="silver-prizes-title">SILVER SPIN PRIZES</div>
        <div class="silver-prizes-grid" id="silverPrizesGrid"></div>
      </div>
    </div>
  </div>

  <!-- GOLDEN SPIN -->
  <div class="spin-wrap" id="goldSpinSection">
    <div class="spin-panel gold-spin-panel">
      <div class="spin-header">
        <div>
          <div class="spin-title gold">GOLDEN SPIN</div>
          <div class="spin-sub">Exclusive premium prizes ¬∑ Higher value rewards ¬∑ Staff activation required</div>
        </div>
        <div class="flash-pill">Premium</div>
      </div>

      <div class="wheel-container">
        <div id="goldenWheel" class="golden-wheel"></div>
        <div class="wheel-center"></div>
        <div class="wheel-pointer"></div>
      </div>

      <div class="spin-code-panel" id="goldCodePanel">
        <div style="font-size: 14px; color: var(--lux-gold); font-weight: 600;">PREMIUM ACTIVATION</div>
        <div class="spin-code-input">
          <input type="password" id="goldCodeInput" maxlength="6" placeholder="000000" />
          <button class="spin-code-btn" id="goldCodeBtn">ACTIVATE</button>
        </div>
        <div class="spin-code-msg" id="goldCodeMsg">Golden Spin requires staff activation</div>
      </div>

      <button class="spin-btn gold" id="goldSpinButton" disabled>ENTER CODE FOR GOLDEN SPIN</button>
      
      <div class="spin-result" id="goldSpinResult">
        <span class="spin-result-main">Premium Golden Spin</span><br/>
        <span class="spin-result-note">Higher stakes, better rewards - activate with staff</span>
      </div>

      <div class="gold-prizes-title">GOLDEN SPIN PRIZES</div>
      <div class="premium-prizes-grid" id="goldPrizesGrid"></div>
    </div>
  </div>

  <!-- Hidden Admin System -->
  <div class="admin-bar">
    System Status: <span id="connectionStatus">Online</span>
  </div>

  <div class="admin-panel" id="adminPanel">
    <div>STAFF CONTROL PANEL</div>
    <div class="admin-badge" id="adminStatus">ACCESS LOCKED</div>

    <div class="admin-row">
      <div>Flash Deals Active</div>
      <div class="switch" id="adminFlashSwitch"><div class="switch-knob"></div></div>
    </div>

    <div class="admin-row">
      <div>Spin Sections Visible</div>
      <div class="switch" id="adminSpinSwitch"><div class="switch-knob"></div></div>
    </div>

    <div class="admin-row">
      <div>Flash Duration (seconds)</div>
      <input id="adminFlashDuration" class="admin-input" type="number" min="30" max="7200" />
    </div>

    <div class="admin-row">
      <div>Discount Product</div>
      <select id="adminDiscountProduct" class="admin-select">
        <option value="">Select Product</option>
      </select>
    </div>

    <div class="admin-row">
      <div>Discount Percentage</div>
      <input id="adminDiscountPercent" class="admin-input" type="number" min="5" max="50" placeholder="%" />
    </div>

    <div class="admin-row">
      <div>Silver Spin Price (‚ÇÆ)</div>
      <input id="adminSilverSpinPrice" class="admin-input" type="number" min="1000" max="50000" />
    </div>

    <div class="admin-row">
      <div>Golden Spin Price (‚ÇÆ)</div>
      <input id="adminGoldSpinPrice" class="admin-input" type="number" min="1000" max="50000" />
    </div>

    <div class="admin-row">
      <div>Quick Preset</div>
      <select id="adminFlashPreset" class="admin-select">
        <option value="">Custom</option>
        <option value="Quick Boost">Quick Boost (2 min / 15%)</option>
        <option value="Happy Hour">Happy Hour (60 min / 20%)</option>
        <option value="Weekend Special">Weekend Special (120 min / 25%)</option>
      </select>
    </div>

    <div class="preset-buttons">
      <button class="preset-btn weekday" data-preset="weekday">Weekday</button>
      <button class="preset-btn weekend" data-preset="weekend">Weekend</button>
      <button class="preset-btn party" data-preset="party">Party</button>
    </div>

    <div id="adminFlashSummary">No active flash deal configuration</div>
  </div>

  <div class="admin-panel" id="adminLoginPanel" style="display:none;">
    <div>STAFF ACCESS REQUIRED</div>
    <div class="admin-login">
      <input type="password" id="adminCodeInput" maxlength="6" placeholder="000000" />
      <button id="adminCodeBtn">UNLOCK</button>
    </div>
    <div id="adminLoginMsg" style="margin-top:10px;font-size:12px;color:var(--danger);display:none;text-align:center;">
      Invalid access code
    </div>
  </div>

  <div class="footer">
    This digital menu is for viewing and promotional purposes only.<br>
    All orders and payments must be processed through our service staff.<br>
    ¬© 2024 Coco Banana Premium Nightclub Experience
  </div>
</div>

<!-- Quick Navigation -->
<div class="quick-nav">
  <button onclick="scrollToSection('cocktails')" aria-label="Cocktails">üç∏</button>
  <button onclick="scrollToSection('beer')" aria-label="Beer">üç∫</button>
  <button onclick="scrollToSection('whiskey')" aria-label="Whiskey">ü•É</button>
  <button onclick="scrollToSection('snacks')" aria-label="Snacks">ü•®</button>
  <button id="scrollTopBtn" onclick="smoothScrollToTop()" aria-label="Back to top">‚¨Ü</button>
</div>

<script>
/* ========= FIREBASE INIT ========= */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT_ID.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ========= SECURE SPIN CONFIG ========= */
const SPIN_ACTIVATION_CODE = '032328';
let isSilverSpinActivated = false;
let isGoldSpinActivated = false;

/* ========= DATA: MENU ========= */
const MENU_DATA = [
  { category: 'cocktails', title: 'Cocktails', tag: 'Premium mixed drinks',
    items: [
      { name: 'Margarita', price: 34000, type: 'cocktail', popular: true },
      { name: 'Negroni', price: 34000, type: 'cocktail' },
      { name: 'Pornstar Martini', price: 34000, type: 'cocktail', popular: true },
      { name: 'Manhattan', price: 34000, type: 'cocktail' },
    ]
  },
  { category: 'beer', title: 'Beer', tag: 'Chilled beers & soju',
    items: [
      { name: 'Altangobi', price: 11000, type: 'beer', popular: true },
      { name: 'Tiger', price: 11000, type: 'beer' },
      { name: 'Ooze', price: 12000, type: 'beer' },
      { name: 'Heineken', price: 13000, type: 'beer' },
      { name: 'Kirin', price: 13000, type: 'beer' },
      { name: 'Chang', price: 13000, type: 'beer' },
      { name: 'Tsingtao', price: 13000, type: 'beer' },
      { name: 'Pearl River', price: 13000, type: 'beer' },
      { name: 'Blue Moon', price: 13000, type: 'beer' },
      { name: 'Asahi', price: 15000, type: 'beer' },
      { name: 'Corona', price: 17000, type: 'beer', popular: true },
      { name: 'Soju', price: 30000, type: 'beer' },
    ]
  },
  { category: 'whiskey', title: 'Whiskey', tag: 'Shot / double / bottle',
    items: [
      { name: 'Wild Turkey', priceText: '14K / 28K / 280K', type: 'spirit' },
      { name: 'Ballantines', priceText: '14K / 28K / 280K', type: 'spirit' },
      { name: 'Jameson', priceText: '15K / 30K / 300K', type: 'spirit', popular: true },
      { name: 'Chivas 12 Years', priceText: '16K / 32K / 320K', type: 'spirit' },
      { name: 'Chivas 18 Years', priceText: '10K / 40K / 400K', type: 'spirit' },
      { name: 'Jack Daniel\'s', priceText: '30K / 60K / 300K', type: 'spirit' },
      { name: 'Glenmorangie', priceText: '30K / 60K / 420K', type: 'spirit' },
    ]
  },
  { category: 'vodka', title: 'Vodka', tag: 'Shot / bottle',
    items: [
      { name: 'Eden 700ml', priceText: '17K / 119K', type: 'spirit' },
      { name: 'Velvet 700ml', priceText: '17K / 119K', type: 'spirit' },
      { name: 'Evok 700ml', priceText: '18K / 126K', type: 'spirit' },
      { name: 'Finlandia 1L', priceText: '23K / 230K', type: 'spirit' },
      { name: 'Absolut 1L', priceText: '25K / 250K', type: 'spirit' },
      { name: 'Grey Goose 1L', priceText: '45K / 450K', type: 'spirit', popular: true },
      { name: 'Beluga 1L', priceText: '46K / 460K', type: 'spirit' },
      { name: 'Zubrowka Bison 700ml', priceText: '35K / 220K', type: 'spirit' },
      { name: 'Zubrowka Biala 700ml', priceText: '35K / 220K', type: 'spirit' },
    ]
  },
  { category: 'gin', title: 'Gin', tag: 'Shot / bottle',
    items: [
      { name: 'Barrister 700ml', priceText: '26K / 182K', type: 'spirit' },
      { name: 'Gordon\'s 1L', priceText: '27K / 270K', type: 'spirit' },
      { name: 'Bombay 1L', priceText: '28K / 280K', type: 'spirit' },
      { name: 'Bialowieski 700ml', priceText: '27K / 192K', type: 'spirit' },
      { name: 'Bialowieski Malina 700ml', priceText: '27K / 192K', type: 'spirit' },
    ]
  },
  { category: 'tequila', title: 'Tequila', tag: 'Shot / bottle',
    items: [
      { name: 'Sierra', priceText: '24K / 240K', type: 'spirit' },
      { name: 'Olmega', priceText: '26K / 182K', type: 'spirit' },
    ]
  },
  { category: 'cognac', title: 'Cognac', tag: 'Premium sips',
    items: [
      { name: 'Hennessy V.S 700ml', priceText: '65K / 455K', type: 'spirit' },
      { name: 'Hennessy V.S.O.P 700ml', priceText: '100K / 700K', type: 'spirit' },
    ]
  },
  { category: 'wine', title: 'Wine', tag: 'Glass / bottle',
    items: [ { name: 'Maison Castle', priceText: '13K / 97.5K', type: 'spirit' } ]
  },
  { category: 'liquor', title: 'Liquor', tag: 'Shot / bottle',
    items: [
      { name: 'Balley\'s 1L', priceText: '18K / 180K', type: 'spirit' },
      { name: 'Grandmarnier 700ml', priceText: '40K / 280K', type: 'spirit' },
      { name: 'J√§germeister 700ml', priceText: '27K / 189K', type: 'spirit' },
    ]
  },
  { category: 'sets', title: 'Set Packages', tag: 'Party bundles',
    items: [
      { name: 'Eden Vodka Set', price: 217000, type: 'set' },
      { name: 'Velvet Vodka Set', price: 217000, type: 'set' },
      { name: 'Evok Vodka Set', price: 224000, type: 'set' },
      { name: 'Finlandia Vodka Set', price: 328000, type: 'set' },
      { name: 'Absolut Vodka Set', price: 348000, type: 'set' },
      { name: 'Grey Goose Vodka Set', price: 548000, type: 'set' },
      { name: 'Beluga Vodka Set', price: 558000, type: 'set' },
      { name: 'Ballantines Whiskey Set', price: 378000, type: 'set' },
      { name: 'Jameson Whiskey Set', price: 398000, type: 'set' },
      { name: 'Jack Daniel\'s Whiskey Set', price: 398000, type: 'set' },
      { name: 'Chivas 12 Years Whiskey Set', price: 418000, type: 'set' },
      { name: 'Chivas 18 Years Whiskey Set', price: 498000, type: 'set' },
    ]
  },
  { category: 'snacks', title: 'Snacks', tag: 'Perfect with drinks',
    items: [
      { name: 'Chips', price: 15000, type: 'snack', popular: true },
      { name: 'Nuts', price: 7000, type: 'snack' },
      { name: 'Gum', price: 5000, type: 'snack' },
      { name: 'Merci', price: 35000, type: 'snack' },
      { name: 'Toffifee', price: 15000, type: 'snack' },
    ]
  },
  { category: 'softdrinks', title: 'Soft Drinks', tag: 'Mixers & refreshments',
    items: [
      { name: 'Juice (Orange, Apple, Multifruit)', price: 4000, type: 'softdrink' },
      { name: 'Bonaqua', price: 5000, type: 'softdrink' },
      { name: 'Cola/Fanta/Sprite', price: 6500, type: 'softdrink' },
      { name: 'Orgiluun', price: 6500, type: 'softdrink' },
      { name: 'Red Bull Yellow', price: 7000, type: 'softdrink' },
      { name: 'Red Bull Blue', price: 10000, type: 'softdrink', popular: true },
    ]
  },
];

/* ========= FLASH STATE ========= */
let FLASH_DEALS_ACTIVE = false;
let FLASH_DURATION_SECONDS = 60;
let CURRENT_FLASH_ITEM = null;
let CURRENT_DISCOUNT_PERCENT = 10;
let SHOW_SPIN = true;

let flashTimeLeft = FLASH_DURATION_SECONDS;
let flashInterval = null;

/* ========= PRIZES ========= */
const SILVER_SPIN_PRIZES = [
  { label: 'FREE Soju', tier: 'big', weight: 4, value: '‚âà30,000‚ÇÆ' },
  { label: 'FREE Cocktail', tier: 'big', weight: 4, value: '‚âà34,000‚ÇÆ' },
  { label: 'FREE Merci Chocolate', tier: 'big', weight: 6, value: '‚âà35,000‚ÇÆ' },
  { label: 'FREE Corona Beer', tier: 'big', weight: 6, value: '‚âà17,000‚ÇÆ' },
  { label: 'FREE Shot', tier: 'big', weight: 5, value: '‚âà17,000‚ÇÆ' },
  { label: 'FREE Altangobi Beer', tier: 'mid', weight: 22 },
  { label: 'FREE Red Bull Blue', tier: 'mid', weight: 22 },
  { label: 'FREE Chips', tier: 'mid', weight: 32 },
  { label: 'FREE Toffifee', tier: 'mid', weight: 32 },
  { label: 'FREE Mixed Nuts', tier: 'mid', weight: 40 },
  { label: 'FREE Soft Drink', tier: 'mid', weight: 22 },
  { label: 'Next Spin 50% OFF', tier: 'mid', weight: 26 },
  { label: 'FREE Gum', tier: 'low', weight: 90 },
  { label: 'FREE Juice', tier: 'low', weight: 90 },
  { label: 'FREE Bonaqua', tier: 'low', weight: 90 },
  { label: 'FREE Red Bull Yellow', tier: 'low', weight: 60 },
  { label: 'Try Again Later', tier: 'low', weight: 230 },
  { label: 'Try Again', tier: 'low', weight: 230 },
];

const GOLDEN_SPIN_PRIZES = [
  { label: 'FREE Cocktail', tier: 'big', weight: 4, value: '‚âà34,000‚ÇÆ' },
  { label: 'FREE Soju', tier: 'big', weight: 4, value: '‚âà30,000‚ÇÆ' },
  { label: 'FREE Corona 2-pack', tier: 'big', weight: 3, value: '‚âà34,000‚ÇÆ' },
  { label: 'FREE Merci Chocolate', tier: 'big', weight: 3, value: '‚âà35,000‚ÇÆ' },
  { label: 'FREE Whiskey Shot + Beer', tier: 'big', weight: 2, value: '‚âà29,000‚ÇÆ' },
  { label: 'FREE Asahi', tier: 'normal', weight: 20, value: '‚âà15,000‚ÇÆ' },
  { label: 'FREE Blue Moon', tier: 'normal', weight: 20, value: '‚âà13,000‚ÇÆ' },
  { label: 'FREE Red Bull Blue', tier: 'normal', weight: 15 },
  { label: 'FREE Chips', tier: 'normal', weight: 15 },
  { label: 'FREE Altangobi Beer', tier: 'normal', weight: 15 },
  { label: 'FREE Corona', tier: 'normal', weight: 120 },
  { label: 'FREE Asahi', tier: 'normal', weight: 100 },
  { label: 'FREE Blue Moon', tier: 'normal', weight: 100 },
  { label: 'FREE Toffifee', tier: 'normal', weight: 80 },
  { label: 'FREE Mixed Nuts', tier: 'normal', weight: 80 },
  { label: '50% OFF Next Spin', tier: 'normal', weight: 80 },
  { label: 'Try Again', tier: 'normal', weight: 80 }
];

/* ========= PRESETS ========= */
const FLASH_PRESETS = [
  { name: "Quick Boost", duration: 120, discount: 15 },
  { name: "Happy Hour", duration: 3600, discount: 20 },
  { name: "Weekend Special", duration: 7200, discount: 25 }
];

/* ========= HELPERS ========= */
function formatPrice(value) { return (value / 1000) + 'K'; }

function scrollToSection(category) {
  const section = document.querySelector(`.section[data-section="${category}"]`);
  if (section) section.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function smoothScrollToTop() {
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* ========= RENDER MENU ========= */
const menuContainer = document.getElementById('menuContainer');

function renderMenu() {
  menuContainer.innerHTML = '';
  MENU_DATA.forEach(section => {
    const sectionEl = document.createElement('div');
    sectionEl.className = 'section';
    sectionEl.dataset.section = section.category;

    const head = document.createElement('div');
    head.className = 'section-head';
    head.innerHTML = `
      <div class="section-title">${section.title}</div>
      <div class="section-tag">${section.tag || ''}</div>
    `;
    sectionEl.appendChild(head);

    const list = document.createElement('div');
    list.className = 'card-list';

    section.items.forEach(item => {
      const card = document.createElement('div');
      card.className = 'card';
      card.dataset.category = section.category;
      card.dataset.name = item.name;

      let priceText = item.priceText || (item.price ? formatPrice(item.price) + '‚ÇÆ' : '');
      const basePriceAttr = item.price ? `data-base-price="${item.price}"` : '';

      if (FLASH_DEALS_ACTIVE && CURRENT_FLASH_ITEM === item.name && item.price) {
        const discountedPrice = Math.round(item.price * (1 - CURRENT_DISCOUNT_PERCENT / 100));
        priceText = `<span class="strike">${formatPrice(item.price)}‚ÇÆ</span> <span class="discount">${formatPrice(discountedPrice)}‚ÇÆ</span>`;
      }

      card.innerHTML = `
        <div class="card-main">
          <div><div class="card-name">${item.name}</div></div>
          <div class="card-price" ${basePriceAttr}>${priceText}</div>
        </div>
      `;

      if (item.popular) {
        const badge = document.createElement('div');
        badge.className = 'popular-badge';
        badge.textContent = 'POPULAR';
        card.appendChild(badge);
      }

      list.appendChild(card);
    });

    sectionEl.appendChild(list);
    menuContainer.appendChild(sectionEl);
  });
}

/* ========= TABS ========= */
const tabsEl = document.getElementById('tabs');
function setActiveTab(tab) {
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.tab === tab));
  document.querySelectorAll('.section').forEach(sec => {
    const cat = sec.dataset.section;
    sec.style.display = (tab === 'all' || tab === cat) ? '' : 'none';
  });
}
tabsEl.addEventListener('click', e => {
  const btn = e.target.closest('.tab-btn');
  if (!btn) return;
  setActiveTab(btn.dataset.tab);
});

/* ========= FLASH UI ========= */
const flashItemName = document.getElementById('flashItemName');
const flashItemMeta = document.getElementById('flashItemMeta');
const flashTimerValue = document.getElementById('flashTimerValue');
const flashMeterFill = document.getElementById('flashMeterFill');
const flashBar = document.getElementById('flashBar');

function formatTime(sec) {
  const m = Math.floor(sec / 60);
  const s = sec % 60;
  return String(m).padStart(2, '0') + ':' + String(s).padStart(2, '0');
}

function updateFlashUI() {
  flashBar.classList.remove('active', 'ending-soon');

  if (!FLASH_DEALS_ACTIVE) {
    flashItemName.textContent = 'No active deals';
    flashItemMeta.textContent = 'Check back for exclusive offers';
    flashTimerValue.textContent = '--:--';
    flashMeterFill.style.transform = 'scaleX(0)';
    flashBar.classList.add('inactive');
    return;
  }

  flashItemName.textContent = CURRENT_FLASH_ITEM || 'Flash Deal Active';
  flashItemMeta.textContent = `${CURRENT_DISCOUNT_PERCENT}% discount`;
  flashTimerValue.textContent = formatTime(flashTimeLeft);
  const progress = Math.max(0, flashTimeLeft / FLASH_DURATION_SECONDS);
  flashMeterFill.style.transform = 'scaleX(' + progress + ')';
  flashBar.classList.remove('inactive');
  flashBar.classList.add('active');

  if (flashTimeLeft <= 10 || flashTimeLeft <= FLASH_DURATION_SECONDS * 0.15) {
    flashBar.classList.add('ending-soon');
  }
}

function startFlashLoop() {
  if (flashInterval) clearInterval(flashInterval);

  if (!FLASH_DEALS_ACTIVE) {
    updateFlashUI();
    renderMenu();
    return;
  }

  flashTimeLeft = FLASH_DURATION_SECONDS;
  updateFlashUI();
  renderMenu();

  flashInterval = setInterval(() => {
    if (!FLASH_DEALS_ACTIVE) {
      updateFlashUI();
      renderMenu();
      return;
    }
    flashTimeLeft--;
    if (flashTimeLeft <= 0) {
      FLASH_DEALS_ACTIVE = false;
      updateFlashUI();
      renderMenu();
      clearInterval(flashInterval);
      saveFirebaseState({ flashActive: false });
    } else {
      updateFlashUI();
    }
  }, 1000);
}

/* ========= SPIN DOM ========= */
const spinButton = document.getElementById('spinButton');
const spinResultEl = document.getElementById('spinResult');
const spinWheel = document.getElementById('spinWheel');
const spinCodePanel = document.getElementById('spinCodePanel');
const spinCodeInput = document.getElementById('spinCodeInput');
const spinCodeBtn = document.getElementById('spinCodeBtn');
const spinCodeMsg = document.getElementById('spinCodeMsg');
const silverPrizesGridEl = document.getElementById('silverPrizesGrid');

const goldSpinButton = document.getElementById('goldSpinButton');
const goldSpinResultEl = document.getElementById('goldSpinResult');
const goldenWheel = document.getElementById('goldenWheel');
const goldCodePanel = document.getElementById('goldCodePanel');
const goldCodeInput = document.getElementById('goldCodeInput');
const goldCodeBtn = document.getElementById('goldCodeBtn');
const goldCodeMsg = document.getElementById('goldCodeMsg');
const goldPrizesGridEl = document.getElementById('goldPrizesGrid');

/* ========= SPIN HELPERS ========= */
function buildPrizePool(prizes) {
  const pool = [];
  prizes.forEach(prize => { for (let i = 0; i < prize.weight; i++) pool.push(prize); });
  return pool;
}
const SILVER_SPIN_POOL = buildPrizePool(SILVER_SPIN_PRIZES);
const GOLD_SPIN_POOL = buildPrizePool(GOLDEN_SPIN_PRIZES);

function randomFromPool(pool) {
  const idx = Math.floor(Math.random() * pool.length);
  return pool[idx];
}

function renderSilverPrizeGrid() {
  silverPrizesGridEl.innerHTML = '';
  SILVER_SPIN_PRIZES.forEach(prize => {
    const div = document.createElement('div');
    div.className = 'prize-item' + (prize.tier === 'big' ? ' big-prize' : '');
    div.innerHTML = `
      <div class="prize-text">${prize.label}</div>
      ${prize.value ? `<div class="prize-value">${prize.value}</div>` : ''}
    `;
    silverPrizesGridEl.appendChild(div);
  });
}

function renderGoldPrizeGrid() {
  goldPrizesGridEl.innerHTML = '';
  GOLDEN_SPIN_PRIZES.forEach(prize => {
    const div = document.createElement('div');
    div.className = 'prize-item' + (prize.tier === 'big' ? ' big-prize' : '');
    div.innerHTML = `
      <div class="prize-text">${prize.label}</div>
      ${prize.value ? `<div class="prize-value">${prize.value}</div>` : ''}
    `;
    goldPrizesGridEl.appendChild(div);
  });
}

/* ========= SILVER SPIN ========= */
function activateSilverSpin() {
  isSilverSpinActivated = true;
  spinButton.disabled = false;
  spinButton.textContent = 'SPIN THE WHEEL';
  spinCodeInput.value = '';
  spinCodeMsg.textContent = 'Silver Spin activated ¬∑ One-time spin.';
  spinCodeMsg.className = 'spin-code-msg spin-code-success';
  setTimeout(() => { spinCodePanel.style.display = 'none'; }, 3000);
}
function deactivateSilverSpin() {
  isSilverSpinActivated = false;
  spinButton.disabled = true;
  spinButton.textContent = 'ENTER CODE TO SPIN';
  spinCodePanel.style.display = '';
  spinCodeMsg.textContent = 'Payment required before spin activation';
  spinCodeMsg.className = 'spin-code-msg';
}
spinCodeBtn.addEventListener('click', () => {
  const code = spinCodeInput.value.trim();
  if (code === SPIN_ACTIVATION_CODE) activateSilverSpin();
  else {
    spinCodeMsg.textContent = 'Invalid code. Please contact staff.';
    spinCodeMsg.className = 'spin-code-msg spin-code-error';
  }
});
spinCodeInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') spinCodeBtn.click(); });

spinButton.addEventListener('click', () => {
  if (!isSilverSpinActivated || spinButton.disabled) return;
  spinButton.disabled = true; spinButton.classList.add('spinning');
  spinWheel.classList.add('spinning');
  spinButton.innerHTML = `<span class="loading-spinner"></span> Spinning...`;

  spinResultEl.innerHTML = `
    <span class="spin-result-main">Spinning...</span><br/>
    <span class="spin-result-note">Good luck!</span>
  `;

  let ticks = 0;
  const maxTicks = 25;
  const tickInterval = 150;
  const tickTimer = setInterval(() => {
    ticks++;
    const tempPrize = randomFromPool(SILVER_SPIN_POOL);
    spinResultEl.innerHTML = `
      <span class="spin-result-main">${tempPrize.label}</span><br/>
      <span class="spin-result-note">...</span>
    `;
    if (ticks >= maxTicks) {
      clearInterval(tickTimer);
      const prize = randomFromPool(SILVER_SPIN_POOL);
      let tierClass = 'low', prefix = 'Result';
      if (prize.tier === 'big') { tierClass = 'big'; prefix = 'BIG WIN üéâ'; }
      else if (prize.tier === 'mid') { tierClass = 'mid'; prefix = 'Win!'; }
      const valueText = (prize.value) ? ` (${prize.value})` : '';
      spinResultEl.innerHTML = `
        <span class="spin-result-main ${tierClass}">${prefix}: ${prize.label}${valueText}</span><br/>
        <span class="spin-result-note">Show staff to claim your prize.</span>
      `;
      setTimeout(() => {
        deactivateSilverSpin();
        spinButton.classList.remove('spinning');
        spinWheel.classList.remove('spinning');
        spinButton.textContent = 'ENTER CODE TO SPIN';
      }, 4000);
    }
  }, tickInterval);
});

/* ========= GOLDEN SPIN ========= */
let goldenSpinDiscountActive = false;
function activateGoldSpin() {
  isGoldSpinActivated = true;
  goldSpinButton.disabled = false;
  goldSpinButton.textContent = 'GOLDEN SPIN ¬∑ 20,000‚ÇÆ';
  goldCodeInput.value = '';
  goldCodeMsg.textContent = 'Golden Spin activated ¬∑ One-time spin.';
  goldCodeMsg.className = 'spin-code-msg spin-code-success';
  setTimeout(() => { goldCodePanel.style.display = 'none'; }, 3000);
}
function deactivateGoldSpin() {
  isGoldSpinActivated = false;
  goldSpinButton.disabled = true;
  goldSpinButton.textContent = 'ENTER CODE FOR GOLDEN SPIN';
  goldSpinButton.classList.remove('discounted');
  goldSpinButton.style.background = '';
  goldCodePanel.style.display = '';
  goldCodeMsg.textContent = 'Golden Spin requires staff activation';
  goldCodeMsg.className = 'spin-code-msg';
  goldenSpinDiscountActive = false;
}
goldCodeBtn.addEventListener('click', () => {
  const code = goldCodeInput.value.trim();
  if (code === SPIN_ACTIVATION_CODE) activateGoldSpin();
  else {
    goldCodeMsg.textContent = 'Invalid code. Please contact staff.';
    goldCodeMsg.className = 'spin-code-msg spin-code-error';
  }
});
goldCodeInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') goldCodeBtn.click(); });

function applyGoldenSpinDiscountOnce() {
  const originalText = 'GOLDEN SPIN ¬∑ 20,000‚ÇÆ';
  const discountText = 'GOLDEN SPIN ¬∑ 10,000‚ÇÆ üî•';
  goldenSpinDiscountActive = true;
  goldSpinButton.textContent = discountText;
  goldSpinButton.style.background = 'linear-gradient(135deg, #ff6b00, #ffd700)';
  goldSpinButton.classList.add('discounted');
  setTimeout(() => {
    goldenSpinDiscountActive = false;
    goldSpinButton.textContent = originalText;
    goldSpinButton.style.background = '';
    goldSpinButton.classList.remove('discounted');
  }, 60000);
}

goldSpinButton.addEventListener('click', () => {
  if (!isGoldSpinActivated || goldSpinButton.disabled) return;
  goldSpinButton.disabled = true; goldSpinButton.classList.add('spinning');
  goldenWheel.classList.add('spinning');
  goldSpinButton.innerHTML = `<span class="loading-spinner"></span> Spinning...`;

  goldSpinResultEl.innerHTML = `
    <span class="spin-result-main">Spinning...</span><br/>
    <span class="spin-result-note">Good luck!</span>
  `;

  let ticks = 0;
  const maxTicks = 30;
  const tickInterval = 150;
  const tickTimer = setInterval(() => {
    ticks++;
    const tempPrize = randomFromPool(GOLD_SPIN_POOL);
    goldSpinResultEl.innerHTML = `
      <span class="spin-result-main">${tempPrize.label}</span><br/>
      <span class="spin-result-note">...</span>
    `;
    if (ticks >= maxTicks) {
      clearInterval(tickTimer);
      const prize = randomFromPool(GOLD_SPIN_POOL);
      let tierClass = 'low', prefix = 'Result';
      if (prize.tier === 'big') { tierClass = 'big'; prefix = 'GOLD WIN üíé'; }
      const valueText = prize.value ? ` (${prize.value})` : '';
      goldSpinResultEl.innerHTML = `
        <span class="spin-result-main ${tierClass}">${prefix}: ${prize.label}${valueText}</span><br/>
        <span class="spin-result-note">Show staff to claim your prize.</span>
      `;
      if (prize.label.includes('50% OFF Next Spin')) applyGoldenSpinDiscountOnce();
      setTimeout(() => {
        deactivateGoldSpin();
        goldSpinButton.classList.remove('spinning');
        goldenWheel.classList.remove('spinning');
        goldSpinButton.textContent = 'ENTER CODE FOR GOLDEN SPIN';
      }, 4000);
    }
  }, tickInterval);
});

/* ========= ADMIN PANEL ========= */
const ADMIN_CODE = '032328';
const adminPanel = document.getElementById('adminPanel');
const adminLoginPanel = document.getElementById('adminLoginPanel');
const adminStatus = document.getElementById('adminStatus');
const adminFlashSwitch = document.getElementById('adminFlashSwitch');
const adminSpinSwitch = document.getElementById('adminSpinSwitch');
const adminFlashDuration = document.getElementById('adminFlashDuration');
const adminDiscountProduct = document.getElementById('adminDiscountProduct');
const adminDiscountPercent = document.getElementById('adminDiscountPercent');
const adminFlashPreset = document.getElementById('adminFlashPreset');
const adminCodeInput = document.getElementById('adminCodeInput');
const adminCodeBtn = document.getElementById('adminCodeBtn');
const adminLoginMsg = document.getElementById('adminLoginMsg');
const adminFlashSummary = document.getElementById('adminFlashSummary');
const connectionStatus = document.getElementById('connectionStatus');
const logoWrap = document.querySelector('.logo-wrap');

/* Hidden admin triggers (5 taps OR 5-second hold on logo) */
let logoTapCount = 0;
let logoTapTimeout = null;
let logoPressTimer = null;

function openAdminLogin() {
  // If already unlocked, just show panel
  if (adminPanel.style.display === 'block') {
    adminLoginPanel.style.display = 'none';
    return;
  }
  adminLoginPanel.style.display = 'block';
  adminLoginMsg.style.display = 'none';
  adminCodeInput.value = '';
  adminCodeInput.focus();
}

function handleLogoTap() {
  logoTapCount++;
  clearTimeout(logoTapTimeout);
  if (logoTapCount >= 5) {
    logoTapCount = 0;
    openAdminLogin();
  } else {
    logoTapTimeout = setTimeout(() => { logoTapCount = 0; }, 1500);
  }
}

function startLogoPress(e) {
  // prevent long-press text selection on mobile
  if (e.type === 'touchstart') e.preventDefault();
  if (logoPressTimer) return;
  logoPressTimer = setTimeout(() => {
    logoPressTimer = null;
    openAdminLogin();
  }, 5000);
}

function cancelLogoPress() {
  if (logoPressTimer) {
    clearTimeout(logoPressTimer);
    logoPressTimer = null;
  }
}

if (logoWrap) {
  logoWrap.addEventListener('click', handleLogoTap);
  logoWrap.addEventListener('mousedown', startLogoPress);
  logoWrap.addEventListener('touchstart', startLogoPress);
  logoWrap.addEventListener('mouseup', cancelLogoPress);
  logoWrap.addEventListener('mouseleave', cancelLogoPress);
  logoWrap.addEventListener('touchend', cancelLogoPress);
  logoWrap.addEventListener('touchcancel', cancelLogoPress);
}

/* Admin helpers */
function setSwitch(el, value) { if (value) el.classList.add('on'); else el.classList.remove('on'); }
function getSwitch(el) { return el.classList.contains('on'); }

function populateProductDropdown() {
  adminDiscountProduct.innerHTML = '<option value="">Select product</option>';
  MENU_DATA.forEach(section => {
    section.items.forEach(item => {
      if (item.price) {
        const option = document.createElement('option');
        option.value = item.name;
        option.textContent = `${item.name} - ${formatPrice(item.price)}‚ÇÆ`;
        adminDiscountProduct.appendChild(option);
      }
    });
  });
  if (CURRENT_FLASH_ITEM) adminDiscountProduct.value = CURRENT_FLASH_ITEM;
}

function updateFlashSummary() {
  if (!CURRENT_FLASH_ITEM) {
    adminFlashSummary.textContent = 'No flash deal configured yet.';
    return;
  }
  adminFlashSummary.textContent =
    `Current flash: ${CURRENT_FLASH_ITEM} at ${CURRENT_DISCOUNT_PERCENT}% for ${FLASH_DURATION_SECONDS} sec.`;
}

function applyFlashPreset(presetName) {
  const preset = FLASH_PRESETS.find(p => p.name === presetName);
  if (!preset) return;
  FLASH_DURATION_SECONDS = preset.duration;
  CURRENT_DISCOUNT_PERCENT = preset.discount;
  adminFlashDuration.value = FLASH_DURATION_SECONDS;
  adminDiscountPercent.value = CURRENT_DISCOUNT_PERCENT;
  updateFlashSummary();
  saveFirebaseState({
    flashDuration: FLASH_DURATION_SECONDS,
    discountPercent: CURRENT_DISCOUNT_PERCENT
  });
}

adminFlashPreset.addEventListener('change', () => {
  const val = adminFlashPreset.value;
  if (val) applyFlashPreset(val);
});

adminCodeBtn.addEventListener('click', () => {
  const code = adminCodeInput.value.trim();
  if (code === ADMIN_CODE) {
    adminLoginMsg.style.display = 'none';
    adminLoginPanel.style.display = 'none';
    adminPanel.style.display = 'block';
    adminStatus.textContent = 'Unlocked ¬∑ Use toggles carefully.';
    populateProductDropdown();
    updateFlashSummary();
  } else {
    adminLoginMsg.style.display = 'block';
  }
});

adminCodeInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter') adminCodeBtn.click();
});

adminFlashSwitch.addEventListener('click', () => {
  setSwitch(adminFlashSwitch, !getSwitch(adminFlashSwitch));
  FLASH_DEALS_ACTIVE = getSwitch(adminFlashSwitch);
  saveFirebaseState({ flashActive: FLASH_DEALS_ACTIVE });
  startFlashLoop();
});

adminSpinSwitch.addEventListener('click', () => {
  setSwitch(adminSpinSwitch, !getSwitch(adminSpinSwitch));
  SHOW_SPIN = getSwitch(adminSpinSwitch);
  document.getElementById('silverSpinSection').style.display = SHOW_SPIN ? '' : 'none';
  document.getElementById('goldSpinSection').style.display = SHOW_SPIN ? '' : 'none';
  saveFirebaseState({ showSpin: SHOW_SPIN });
});

adminFlashDuration.addEventListener('change', () => {
  const v = parseInt(adminFlashDuration.value, 10);
  if (!isNaN(v) && v >= 20 && v <= 7200) {
    FLASH_DURATION_SECONDS = v;
    saveFirebaseState({ flashDuration: FLASH_DURATION_SECONDS });
    if (FLASH_DEALS_ACTIVE) startFlashLoop();
    updateFlashSummary();
  }
});

adminDiscountProduct.addEventListener('change', () => {
  CURRENT_FLASH_ITEM = adminDiscountProduct.value || null;
  saveFirebaseState({ discountProduct: CURRENT_FLASH_ITEM });
  updateFlashSummary();
});

adminDiscountPercent.addEventListener('change', () => {
  const v = parseInt(adminDiscountPercent.value, 10);
  if (!isNaN(v) && v >= 5 && v <= 50) {
    CURRENT_DISCOUNT_PERCENT = v;
    saveFirebaseState({ discountPercent: CURRENT_DISCOUNT_PERCENT });
    updateFlashSummary();
  }
});

/* ========= FIRESTORE STATE MANAGEMENT ========= */
const STATE_COLLECTION = 'menuState';
const STATE_DOC_ID = 'currentState';
const loadingSkeletonEl = document.getElementById('loadingSkeleton');

async function loadFirebaseState() {
  loadingSkeletonEl.style.display = 'block';
  if (connectionStatus) connectionStatus.textContent = 'Syncing...';
  try {
    const docRef = db.collection(STATE_COLLECTION).doc(STATE_DOC_ID);
    const snap = await docRef.get();
    if (snap.exists) {
      const st = snap.data();
      applyFirebaseStateToVars(st);
      updateUIFromFirebase();
    } else {
      const defaultState = {
        flashActive: false,
        showSpin: true,
        flashDuration: 60,
        discountProduct: null,
        discountPercent: 10,
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
      };
      await docRef.set(defaultState, { merge: true });
      applyFirebaseStateToVars(defaultState);
      updateUIFromFirebase();
    }
    loadingSkeletonEl.style.display = 'none';
    if (connectionStatus) connectionStatus.textContent = 'Online';
  } catch (err) {
    console.error('Error loading Firestore state:', err);
    loadingSkeletonEl.style.display = 'none';
    if (connectionStatus) connectionStatus.textContent = 'Offline (menu still works)';
    updateUIFromFirebase();
  }
}

function applyFirebaseStateToVars(st) {
  FLASH_DEALS_ACTIVE = !!st.flashActive;
  SHOW_SPIN = st.showSpin !== false;
  FLASH_DURATION_SECONDS = typeof st.flashDuration === 'number' ? st.flashDuration : FLASH_DURATION_SECONDS;
  CURRENT_FLASH_ITEM = st.discountProduct || null;
  CURRENT_DISCOUNT_PERCENT = typeof st.discountPercent === 'number' ? st.discountPercent : CURRENT_DISCOUNT_PERCENT;
  flashTimeLeft = FLASH_DURATION_SECONDS;
}

function updateUIFromFirebase() {
  setSwitch(adminFlashSwitch, FLASH_DEALS_ACTIVE);
  setSwitch(adminSpinSwitch, SHOW_SPIN);
  adminFlashDuration.value = FLASH_DURATION_SECONDS;
  adminDiscountPercent.value = CURRENT_DISCOUNT_PERCENT;

  document.getElementById('silverSpinSection').style.display = SHOW_SPIN ? '' : 'none';
  document.getElementById('goldSpinSection').style.display = SHOW_SPIN ? '' : 'none';

  renderMenu();
  updateFlashUI();
  updateFlashSummary();

  if (FLASH_DEALS_ACTIVE) startFlashLoop();
}

function saveFirebaseState(patch) {
  const docRef = db.collection(STATE_COLLECTION).doc(STATE_DOC_ID);
  const updateObj = { ...patch, updatedAt: firebase.firestore.FieldValue.serverTimestamp() };
  return docRef.set(updateObj, { merge: true });
}

function setupRealtimeListener() {
  db.collection(STATE_COLLECTION).doc(STATE_DOC_ID)
    .onSnapshot((snap) => {
      if (!snap.exists) return;
      const st = snap.data();
      applyFirebaseStateToVars(st);
      updateUIFromFirebase();
      if (connectionStatus) connectionStatus.textContent = 'Online';
    }, (err) => {
      console.error('Realtime listener error:', err);
      if (connectionStatus) connectionStatus.textContent = 'Connection issue';
    });
}

/* ========= SCROLL TO TOP BUTTON ========= */
const scrollTopBtn = document.getElementById('scrollTopBtn');
window.addEventListener('scroll', () => {
  if (window.scrollY > 300) {
    scrollTopBtn.style.display = 'flex';
  } else {
    scrollTopBtn.style.display = 'none';
  }
});

/* ========= INIT ========= */
function init() {
  renderSilverPrizeGrid();
  renderGoldPrizeGrid();
  setActiveTab('all');
  deactivateSilverSpin();
  deactivateGoldSpin();
  loadFirebaseState();
  setupRealtimeListener();
}
init();
</script>
</body>
</html>
